 Private Sub Bestill_Click(sender As Object, e As EventArgs) Handles Bestill.Click

        'Validerer input

        If ComboBox1.Text = "Klokkeslett" Then
            MsgBox("Vennligst velg et tidspunkt fra menyen")

        ElseIf DateTimePicker1.Value.Date <= Date.Today Then
            MsgBox("Du kan kun bestille time fra og med i morgen")

        Else

            'Sender timebestilling

            Dim dato As String = DateTimePicker1.Value.ToString("yyyy-MM-dd")
            Dim tid As String = ComboBox1.Text & ":00"

            'MsgBox("Dato: " & dato & " Tid: " & tid)

            Dim bestillSporring = "INSERT INTO `Sende_bestilling` ( `bestilling_dato`, `bestilling_klokke`, `giver_id`)
                                   VALUES ('" & dato & "' ,'" & tid & "' , (SELECT bruker_id FROM Bruker
                                   WHERE epost ='" & Startside.brukernavn & "'))"

            Dim sqlbestill As New MySqlCommand(bestillSporring, tilkobling)
            Dim leserbestill = sqlbestill.ExecuteReader()
            leserbestill.Close()

            MsgBox("Din bestilling er sendt." & vbCrLf & vbCrLf & "Dato: " & dato & " Tid: " & tid)


        End If

    End Sub


______________________________________________________________________________________________________________________________________________________________________________




Private Sub MinSideGiver_Load(sender As Object, e As EventArgs) Handles MyBase.Load

        'Setter bakgrunnsfarge til hvit
        Me.BackColor = Color.White
        Me.Text = "Blodbanken St. Olavs"
        MenuStrip1.BackColor = Color.Red

        'Plasserer innholdet i midten av vinduet

        GroupBox3.Location = New Point((Me.Width \ 2) - (GroupBox3.Width \ 2), (Me.Height \ 2) - (GroupBox3.Height \ 2))



        'SQL-spørring som henter ut personlig informasjon

        Dim navnSporring = "SELECT epost, f_navn, e_navn, postnr, adresse, tlf_nr, fodselsdato, blodtype
                            from Bruker WHERE epost='" & Startside.brukernavn & "'"
        Dim sqlnavn As New MySqlCommand(navnSporring, tilkobling)

        'Leser som lister ut informasjonen i labelsene

        Dim lesernavn = sqlnavn.ExecuteReader()

        While lesernavn.Read()

            Navn.Text = lesernavn("f_navn") & " " & lesernavn("e_navn")
            Postnr.Text = lesernavn("postnr")
            Epost.Text = lesernavn("epost")
            fdato.Text = lesernavn("fodselsdato")
            Adresse.Text = lesernavn("adresse")
            Mobilnummer.Text = lesernavn("tlf_nr")
            Blodtype.Text = lesernavn("blodtype")
        End While
        lesernavn.Close()

        'Henter siste blodgivning og antall dager siden sist

        Try

            Dim giverSporring = "SELECT MAX( bg.givning_dato ) AS MaxDate, DATEDIFF( CURDATE( ) , bg.givning_dato ) AS DiffDate
                FROM Blodgivning bg, Bruker b
                WHERE bg.giver_id = b.bruker_id
                AND b.epost ='" & Startside.brukernavn & "'"
            Dim sqlgiver As New MySqlCommand(giverSporring, tilkobling)
            Dim lesergiver = sqlgiver.ExecuteReader()

            'Viser siste blodgivning og antall dager til neste blodgivning i label

            While lesergiver.Read()
                Forrige.Text = lesergiver("MaxDate")
                Neste.Text = 90 - lesergiver("DiffDate")
            End While

            lesergiver.Close()

            If Neste.Text < 1 Then
                Neste.Text = ""
                Nestetekst.Text = "Du kan nå gi blod igjen. Send timebestilling nå!"
            End If

            'Håndterer dersom spørringen ikke returnerer noen blodgivninger

        Catch ex As Exception
            Forrige.Text = "Ingen registrert blodgivning"
            Neste.Text = ""
            Nestetekst.Text = "Ingen registrert blodgivning"

        End Try

    End Sub




        'Dim ds As New DataSet
        'Dim navnSporring = "SELECT epost, f_navn, e_navn, passord, adresse, tlf_nr, postnr from Bruker "
        'Dim sqlnavn2 As New MySqlCommand(navnSporring, tilkobling2)
        'Dim lesernavn = sqlnavn2.ExecuteReader()
        'Try


        '    While lesernavn.Read()

        '        DataGridView1.Item(1, 1) = lesernavn("f_navn")
        '        DataGridView1.Item(1, 2) = lesernavn("e_navn")
        ' -------------------------

        'Endre_epost.Text = lesernavn("epost")
        'Endre_passord1.Text = lesernavn("passord")
        'Endre_passord2.Text = lesernavn("passord")
        'Endre_adresse.Text = lesernavn("adresse")
        'Endre_postnr.Text = lesernavn("postnr")
        'Endre_tlfnr.Text = lesernavn("tlf_nr")
        '    'Mobilnummer.Text = lesernavn("tlf_nr")
        '    'Blodtype.Text = lesernavn("blodtype")
        '-----------------
        'End While
        '    lesernavn.Close()
        'Catch ex As MySqlException
        '    MsgBox(ex.Message)
        'End Try






 Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click


        Dim ds As New DataSet
        Dim navnSporring = "SELECT bruker_id, epost, f_navn, e_navn, postnr, adresse, tlf_nr, blodtype
                            from Bruker WHERE bruker_type =2 ORDER BY bruker_id "
        Dim sqlnavn As New MySqlCommand(navnSporring, tilkobling)
        Dim lesernavn = sqlnavn.ExecuteReader()

        ListBox1.Items.Clear()

        ListBox1.Items.Add("Bruker ID" & "Fornavn" & vbTab & vbTab & "Etternavn" & vbTab & vbTab & "Epost")



        While lesernavn.Read()



            ListBox1.Items.Add(lesernavn("bruker_id") & vbTab & lesernavn("f_navn") & vbTab & vbTab & lesernavn("e_navn") & vbTab & vbTab & lesernavn("epost"))


        End While
        lesernavn.Close()



    End Sub



 Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click

        Dim ds As New DataSet
        Dim navnSporring = "SELECT bruker_id, epost, f_navn, e_navn, postnr, adresse, tlf_nr, blodtype
                            from Bruker WHERE bruker_type =1 ORDER BY bruker_id "
        Dim sqlnavn As New MySqlCommand(navnSporring, tilkobling)
        Dim lesernavn = sqlnavn.ExecuteReader()

        ListBox1.Items.Clear()

        ListBox1.Items.Add("Bruker ID" & "Fornavn" & vbTab & vbTab & "Etternavn" & vbTab & vbTab & "Epost")



        While lesernavn.Read()



            ListBox1.Items.Add(lesernavn("bruker_id") & vbTab & lesernavn("f_navn") & vbTab & vbTab & lesernavn("e_navn") & vbTab & vbTab & lesernavn("epost"))


        End While
        lesernavn.Close()
    End Sub

------------------

 Private Function sporring(ByVal sql As String) As DataTable
        Dim tabell As New DataTable

        Try
            tilkobling.Open()

            Dim kommando As New MySqlCommand(sql, tilkobling)
            Dim da As New MySqlDataAdapter
            da.SelectCommand = kommando
            da.Fill(tabell)
            tilkobling.Close()
        Catch ex As MySqlException
            MessageBox.Show("en feil har oppstått" & ex.Message)
        End Try

        Return tabell


    End Function


--------------------

    'Private Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click

    '    Dim posisjon As Integer
    '    Dim antall As Integer
    '    Dim ds As New DataSet
    '    Dim navnSporring = "Select bruker_id, epost, f_navn, e_navn, postnr, adresse, tlf_nr, Fodselsdato, blodtype
    '                        from Bruker WHERE bruker_id='" & posisjon & "'"
    '    Dim sqlnavn As New MySqlCommand(navnSporring, tilkobling)
    '    Dim lesernavn = sqlnavn.ExecuteReader()




    '    If posisjon < Antall Then
    '        Try
    '            While lesernavn.Read()
    '                posisjon = posisjon + 1
    '                Navn.Text = lesernavn("f_navn") & " " & lesernavn("e_navn")
    '                Postnr.Text = lesernavn("postnr")
    '                Epost.Text = lesernavn("epost")
    '                fdato.Text = lesernavn("fodselsdato")
    '                Adresse.Text = lesernavn("adresse")
    '                Mobilnummer.Text = lesernavn("tlf_nr")
    '                Blodtype.Text = lesernavn("blodtype")
    '            End While
    '            lesernavn.Close()

    '        Catch ex As Exception

    '        End Try

    '    End If

    'End Sub

 Private Sub Se_brukere_Click(sender As Object, e As EventArgs)
        Dim SDA As New MySqlDataAdapter
        Dim dbDataset As New DataTable
        Dim bSource As New BindingSource
        Try

            Dim navnSporring = "Select bruker_id, f_navn, e_navn, epost, passord, adresse, tlf_nr, postnr from Bruker "
            Dim sqlnavn2 As New MySqlCommand(navnSporring, tilkobling3)
            SDA.SelectCommand = sqlnavn2
            SDA.Fill(dbDataset)
            bSource.DataSource = dbDataset
            DataGridView2.DataSource = bSource
            SDA.Update(dbDataset)

        Catch ex As MySqlException
            MsgBox(ex.Message)
        End Try

    End Sub

--------------------------

  ' bruker_id, bruker_type, fodselsdato, f_navn, e_navn, epost, passord, tlf_nr, adresse, postnr, kjonn, epost_godtatt, blodtype
   
----------------
-----

    'Private Sub load_table()
    '    Dim SDA As New MySqlDataAdapter
    '    Dim dbDataset As New DataTable
    '    Dim bSource As New BindingSource
    '    Try

    '        Dim navnSporring = "SELECT epost, f_navn, e_navn, passord, adresse, tlf_nr, postnr from Bruker "
    '        Dim sqlnavn2 As New MySqlCommand(navnSporring, tilkobling2)
    '        SDA.SelectCommand = sqlnavn2
    '        SDA.Fill(dbDataset)
    '        bSource.DataSource = dbDataset
    '        DataGridView2.DataSource = bSource
    '        SDA.Update(dbDataset)

    '    Catch ex As MySqlException
    '        MsgBox(ex.Message)
    '    End Try


    'End Sub

    'Private Sub AvsluttToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles AvsluttToolStripMenuItem.Click
    '    'Avslutter programmet
    '    Me.Close()
    'End Sub




    'Private Sub AvsluttToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles AvsluttToolStripMenuItem.Click
    '    'Avslutter programmet
    '    Me.Close()
    'End Sub
---------------

